<section class="stats-grid">
  <!-- Catas Totales -->
  <div class="stat-card total-tastings">
    <div class="stat-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path
          d="M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <!-- Líneas de humo del café -->
        <line x1="6" y1="1" x2="6" y2="4" stroke-width="1.5" stroke-linecap="round" />
        <line x1="10" y1="1" x2="10" y2="4" stroke-width="1.5" stroke-linecap="round" />
        <line x1="14" y1="1" x2="14" y2="4" stroke-width="1.5" stroke-linecap="round" />
      </svg>
    </div>
    <div class="stat-content">
      <h3 class="stat-value">{{ totalTastings }}</h3>
      <p class="stat-label" i18n="@@totalTastingsLabel">Experiencias de Cata Registradas</p>
    </div>
  </div>

  <!-- Top 3 Orígenes -->
  <div class="stat-card top-origins">
    <div class="stat-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path
          d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <circle cx="12" cy="10" r="3" stroke-width="2" />
      </svg>
    </div>
    <div class="stat-content">
      <p class="stat-label" i18n="@@topOriginsLabel">Orígenes Más Degustados</p>
      <div class="origins-list">
        @for (origin of topOrigins; track origin.name; let i = $index) {
          <div class="origin-item">
            <span class="origin-rank">{{ i + 1 }}.</span>
            <span class="fi fi-{{ getCountryFlag(origin.name) }} origin-flag"></span>
            <span class="origin-name">{{ origin.name }}</span>
            <span class="origin-count">({{ origin.count }})</span>
          </div>
        }
        @if (topOrigins.length === 0) {
          <span class="no-data">Registra más catas para ver estadísticas</span>
        }
      </div>
    </div>
  </div>

  <!-- Tueste Favorito -->
  <div class="stat-card favorite-roast">
    <div class="stat-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path
          d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
    </div>
    <div class="stat-content">
      <h3 class="stat-value">{{ favoriteRoast || 'N/A' }}</h3>
      <p class="stat-label" i18n="@@favoriteRoastLabel">Nivel de Tueste Preferido</p>
    </div>
  </div>

  <!-- Método Favorito -->
  <div class="stat-card favorite-method">
    <div class="stat-icon">
      @if (favoriteBrewMethod && favoriteBrewMethod !== 'N/A') {
        <img [src]="getBrewMethodImage(favoriteBrewMethod)" [alt]="favoriteBrewMethod" class="brew-method-image">
      } @else {
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path
            d="M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <line x1="6" y1="1" x2="6" y2="4" stroke-width="2" stroke-linecap="round" />
          <line x1="10" y1="1" x2="10" y2="4" stroke-width="2" stroke-linecap="round" />
          <line x1="14" y1="1" x2="14" y2="4" stroke-width="2" stroke-linecap="round" />
        </svg>
      }
    </div>
    <div class="stat-content">
      <h3 class="stat-value">{{ favoriteBrewMethod || 'N/A' }}</h3>
      <p class="stat-label" i18n="@@favoriteMethodLabel">Método de Preparación Favorito</p>
    </div>
  </div>

  <!-- Tendencia -->
  <div class="stat-card trend-card">
    <div class="stat-icon">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
      </svg>
    </div>
    <div class="stat-content">
      <p class="stat-label" i18n="@@trendLabel">Patrón de Degustación</p>
      @if (insights.length > 0) {
        <div class="insights-rotator">
          @for (insight of insights; track insight.message; let i = $index) {
            <p class="trend-text insight-item" [class.active]="i === currentInsightIndex">
              {{ insight.message }}
            </p>
          }
        </div>
      } @else {
        <p class="trend-text">{{ tastingTrend || 'Continúa registrando catas para descubrir tu patrón' }}</p>
      }
    </div>
  </div>
</section>
