<div class="auth-container">
  <!-- Coffee Bean Decorations -->
  <div class="coffee-bean bean-1"></div>
  <div class="coffee-bean bean-2"></div>
  <div class="coffee-bean bean-3"></div>

  <div class="auth-card">
    <!-- Back Button -->
    <button class="back-button" (click)="goBack()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path
          d="M19 12H5M12 19l-7-7 7-7"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
      {{ 'backButton' | translate }}
    </button>

    <!-- Logo -->
    <div class="logo">
      <svg class="coffee-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path
          d="M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8z"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <line x1="6" y1="1" x2="6" y2="4" stroke-width="2" stroke-linecap="round" />
        <line x1="10" y1="1" x2="10" y2="4" stroke-width="2" stroke-linecap="round" />
        <line x1="14" y1="1" x2="14" y2="4" stroke-width="2" stroke-linecap="round" />
      </svg>
    </div>

    <!-- Title -->
    <h2 class="auth-title">
      {{ isLogin() ? ('loginTitle' | translate) : ('signupTitle' | translate) }}
    </h2>
    <p class="auth-subtitle">
      {{ isLogin() ? ('loginSubtitle' | translate) : ('signupSubtitle' | translate) }}
    </p>

    <!-- Error/Success Messages -->
    @if (errorMessage()) {
    <div class="alert alert-error">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <circle cx="12" cy="12" r="10" stroke-width="2" />
        <line x1="12" y1="8" x2="12" y2="12" stroke-width="2" stroke-linecap="round" />
        <line x1="12" y1="16" x2="12.01" y2="16" stroke-width="2" stroke-linecap="round" />
      </svg>
      {{ errorMessage() }}
    </div>
    } @if (successMessage()) {
    <div class="alert alert-success">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
        <path
          d="M22 11.08V12a10 10 0 1 1-5.93-9.14"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
        <polyline
          points="22 4 12 14.01 9 11.01"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        />
      </svg>
      {{ successMessage() }}
    </div>
    }

    <!-- Auth Form -->
    <form (ngSubmit)="onSubmit()" class="auth-form">
      @if (!isLogin()) {
      <div class="form-group">
        <label for="username">{{ 'usernameLabel' | translate }}</label>
        <input
          type="text"
          id="username"
          [(ngModel)]="username"
          name="username"
          [placeholder]="'usernamePlaceholder' | translate"
          required
        />
      </div>
      }

      <div class="form-group">
        <label for="email">{{ 'emailLabel' | translate }}</label>
        <input
          type="email"
          id="email"
          [(ngModel)]="email"
          name="email"
          [placeholder]="'emailPlaceholder' | translate"
          required
        />
      </div>

      <div class="form-group">
        <label for="password">{{ 'passwordLabel' | translate }}</label>
        <input
          type="password"
          id="password"
          [(ngModel)]="password"
          name="password"
          [placeholder]="'passwordPlaceholder' | translate"
          required
        />
      </div>

      @if (!isLogin()) {
      <div class="form-group">
        <label for="confirmPassword">{{ 'confirmPasswordLabel' | translate }}</label>
        <input
          type="password"
          id="confirmPassword"
          [(ngModel)]="confirmPassword"
          name="confirmPassword"
          [placeholder]="'confirmPasswordPlaceholder' | translate"
          required
        />
      </div>
      }

      <button type="submit" class="submit-button" [disabled]="isLoading()">
        @if (isLoading()) {
        <span class="spinner"></span>
        } @else {
        {{ isLogin() ? ('signInButton' | translate) : ('signUpButton' | translate) }}
        }
      </button>
      <!-- Magic Link -->
      @if (isLogin()) {
      <button
        type="button"
        class="magic-link-button"
        (click)="signInWithMagicLink()"
        [disabled]="isLoading()"
      >
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
          <path
            d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <polyline
            points="22,6 12,13 2,6"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
        {{ 'magicLinkButton' | translate }}
      </button>
      }
    </form>

    <!-- Toggle Mode -->
    <div class="toggle-mode">
      <p>
        {{ isLogin() ? ('noAccountText' | translate) : ('hasAccountText' | translate) }}
        <button type="button" class="link-button" (click)="toggleMode()">
          {{ isLogin() ? ('signUpButton' | translate) : ('signInButton' | translate) }}
        </button>
      </p>
    </div>
  </div>
</div>
